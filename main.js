!function(){var e={240:function(){}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";const e=[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=document.querySelector("#add-card-form"),n=document.querySelector("#edit-profile-form"),i=n.querySelector(".modal__input_type_name"),o=n.querySelector(".modal__input_type_descripion"),a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button");function d(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__exit-button"))&&this.close()}))}}class u extends c{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}var _=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this.checkInputValidity(e),this.toggleButtonState()}))}))}checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}},m=s(240),p=s.n(m);const h=new class extends c{constructor(e){super(e),this._modalImage=this._popupElement.querySelector(".modal__image"),this._modalText=this._popupElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=`Image ${e.link}`,this._modalText.textContent=e.name,super.open()}}("#image-modal"),g=new class{constructor(e,t){let{items:s,renderer:r}=e;this._renderedItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach(this._renderer)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}({items:e,renderer:e=>{const t=v(e);g.addItem(t)}},".cards__list"),E=new class{constructor(e){let{userName:t,userJob:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e){let{profileName:t,profileJob:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}}({userName:".profile__title",userJob:".profile__description"}),b=new u({popupSelector:"#edit-modal",handleFormSubmit:e=>{E.setUserInfo({profileName:e.title,profileJob:e.description}),b.close()}}),v=e=>new class{constructor(e,t){let{data:s,toggleImageClick:r}=e;d(this,"_toggleCardLike",(()=>{this._cardLikeBtn.classList.toggle("card__like-button_active")})),d(this,"_toggleCardDelete",(()=>{this._cardElement.remove()})),this._name=s.name,this._link=s.link,this._toggleImageClick=r,this._cardSelector=t}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._setEventListeners(),this._imageEl.src=this._link,this._imageEl.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._cardElement}_setEventListeners(){this._cardLikeBtn=this._cardElement.querySelector(".card__like-button"),this._cardLikeBtn.addEventListener("click",(()=>this._toggleCardLike())),this._cardDeleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardDeleteBtn.addEventListener("click",(()=>this._toggleCardDelete())),this._imageEl=this._cardElement.querySelector(".card__image"),this._imageEl.addEventListener("click",(()=>this._toggleImageClick({name:this._name,link:this._link})))}}({data:e,toggleImageClick:e=>{h.open(e)}},"#card-template").getView(),f=new u({popupSelector:"#add-modal",handleFormSubmit:e=>{!function(e){const t=v(e);g.prependItem(t)}({name:e.title,link:e.link}),f.close()}}),y=new _(t,n),S=new _(t,r);new(p())({baseUrl:"https://around.nomoreparties.co/v1/group-12",authToken:"eb433773-4d2e-4e42-9076-4dd771b1e5ef"}).getInitialCards().then((e=>console.log(e))),g.renderItems(e),h.setEventListeners(),b.setEventListeners(),f.setEventListeners(),y.enableValidation(),S.enableValidation(),a.addEventListener("click",(()=>{!function(){const{name:e,job:t}=E.getUserInfo();i.value=e,o.value=t}(),b.open(),y.resetValidation()})),l.addEventListener("click",(()=>{f.open(),S.resetValidation()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cEQsRUFBY25ELEtBQUt1RyxFQUFRLEdKcENuQixrQkl5Q0ZMLFVBSVJNLEVBQWUsSUFBSS9GLEVBQWUsQ0FDdENoQixjSmhEVSxhSWlEVmlCLGlCQUFtQlMsS0FyQnJCLFNBQW9CbUMsR0FDbEIsTUFBTW1ELEVBQWFsQyxFQUFXakIsR0FDOUJHLEVBQVlXLFlBQVlxQyxFQUMxQixDQW9CSUMsQ0FEb0IsQ0FBRXBJLEtBQU02QyxFQUFNZ0UsTUFBTzVHLEtBQU00QyxFQUFNNUMsT0FFckRpSSxFQUFhekcsT0FBTyxJQU9sQjRHLEVBQW9CLElBQUlDLEVBQWNwSSxFQUFVVSxHQUVoRDJILEVBQW1CLElBQUlELEVBQWNwSSxFQUFVTyxHQUl6QyxJQUFJK0gsSUFBSixDQUFRLENBQ2xCQyxRQUFTLDhDQUNUQyxVQUFXLHlDQUdUQyxrQkFBa0JDLE1BQU1DLEdBQVFDLFFBQVFDLElBQUlGLEtBS2hEMUQsRUFBWU8sWUFBWTNGLEdBQ3hCOEUsRUFBYzdDLG9CQUNkNEUsRUFBaUI1RSxvQkFDakJrRyxFQUFhbEcsb0JBRWJxRyxFQUFrQjdFLG1CQUNsQitFLEVBQWlCL0UsbUJBT2pCekMsRUFBa0JjLGlCQUFpQixTQUFTLE1BbEY1QyxXQUNFLE1BQU0sS0FBRTdCLEVBQUksSUFBRXdHLEdBQVFOLEVBQVNLLGNBQy9CMUYsRUFBa0JpQyxNQUFROUMsRUFDMUJjLEVBQXdCZ0MsTUFBUTBELENBQ2xDLENBK0VFd0MsR0FDQXBDLEVBQWlCbEYsT0FDakIyRyxFQUFrQjNELGlCQUFpQixJQUdyQzFELEVBQWNhLGlCQUFpQixTQUFTLEtBQ3RDcUcsRUFBYXhHLE9BQ2I2RyxFQUFpQjdELGlCQUFpQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1zLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG4vLyBGb3JtVmFsaWRhdGlvblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbi8vIENhbGxpbmcgbmV3IGNsYXNzZXNcclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBjYXJkTGlzdDogXCIuY2FyZHNfX2xpc3RcIixcclxuICBjYXJkVGVtcGxhdGU6IFwiLmNhcmRfX3RlbXBsYXRlXCIsXHJcbiAgdmlld01vZGFsOiBcIiNpbWFnZS1tb2RhbFwiLCAvLyBcIi5cIiBpbiBQb3B1cC5qc1xyXG4gIHVzZXJOYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHVzZXJKb2I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYWRkTW9kYWw6IFwiI2FkZC1tb2RhbFwiLFxyXG4gIGVkaXRNb2RhbDogXCIjZWRpdC1tb2RhbFwiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG59O1xyXG5cclxuLyogSW5wdXQgZmllbGRzIGluIEVkaXQgYnV0dG9uICovXHJcbmV4cG9ydCBjb25zdCBjYXJkQWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBwcm9maWxlRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9uYW1lXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gcHJvZmlsZUVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcGlvblwiXHJcbik7XHJcblxyXG4vLyBCdXR0b25zXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIC8vIHRoaXMuX3BvcHVwRWxlbWVudCA9IG1vZGFsXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpOyAvLyAoLmJpbmQodGhpcykpIG5lZWRlZCB0byBub3QgbG9zZWUgbG9zZSBjb250ZXh0ICd0aGlzJ1xyXG4gIH1cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAvKiBDbG9zZXMgcG9wdXAgd2hlbiAnRXNjJyBrZXkgcHJlc3NlZCAqL1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgLy8gTWV0aG9kIGNhbGxlZCA9IGFkZGluZyBjbGFzcyBhbmQgZXZlbnRMaXN0ZW5lclxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgLy8gTWV0aG9kIGNhbGxlZCA9IHJlbW92aW5nIGNsYXNzIGFuZCBldmVudExpc3RlbmVyXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIC8vV2hlbiB0aGUgRXNjYXBlIGtleSBpcyBwcmVzc2VkIGNsb3NlTW9kYWxcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvKiBDbG9zZSBNb2RhbCB3aGVuIHlvdSBjbGljazogb24gc2hhZGVkIGFyZWEgb2YgZm9ybVxyXG4gICAgICAgb3IgY2xvc2UgaWNvbiBvZiBNb2RhbCAqL1xyXG4gICAgLy8gTW91c2Vkb3duID0gT25sdCB3aGVuIHlvdSBjbGljayBvbiBhcmVhcyB0aGF0IGNhbiBjbG9zZVxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19leGl0LWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbi8vIFNlbGVjdHMgZmllbGRzIGluIHBsdXMtaWNvbiAoYWRkLUJ1dHRvbilcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybXMgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICAvLyBpbnB1dExpc3QgYWNjZXNzZXMgYWxsIGlucHV0IGZpZWxkc1xyXG4gICAgLyogaGFuZGxlRm9ybVN1Ym1pdCA9IGNhbGxiYWNrIHRoYXQgUG9wdXBXaXRoRm9ybSBcclxuICAgICAgICAgICBjYWxscyB3aGVuIHRoZSBmb3JtcyBzdWJtaXQgZXZlbnQgZmlyZXMgKi9cclxuICB9XHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gICAgLyogQ29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIFxyXG4gICAgICAgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdCAqL1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAvLyBDYWxsIGZ1bmN0aW9uIGluIGZ1bmN0aW9uXHJcbiAgICB9KTtcclxuICAgIC8qICBBZGQgdGhlIHN1Ym1pdCBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtIFxyXG4gICAgICAgIGFuZCB0aGUgY2xpY2sgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24qL1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIC8vIFJlc2V0cyB0aGUgZm9ybSBvbmNlIHRoZSBwb3B1cCBpcyBjbG9zZWRcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAvLyBQcml2YXRlXHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIC8vIEdyYWJzIGZvcm1FbGVtZW50XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgLy8gQ2FsbCBvbiB0aGUgbWV0aG9kIChzZXRFdmVudExpc3RlbmVycykgd2l0aGluIHRoZSBjbGFzc1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHN1Ym1pdCwgaW5wdXQgZmllbGRzLCBhbmQgKGNvbnN0cnVjdG9yKVxyXG4gICAgICAgIC8qIE90aGVyIHBhcmFtZXRlcnMgYXJlbid0IGNhbGxlZCBiYyBcclxuICAgICAgICAgICB0aGV5IGNhbiBiZSByZWZlcnJlZCB0byBhcyAndGhpcycgKi9cclxuICAgICAgICAvLyBCb3RoIG1ldGhvZHMgYXJlIHB1YmxpYyAoY2FuIGJlIHVzZWQgaW4gb3RoZXIganMgZmlsZXMpXHJcbiAgICAgICAgdGhpcy5jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAvLyBQYXNzIGluIGlucHV0IGZpZWxkcywgc2F2ZS1idXR0b24sIGFuZCBjb25zdHJ1Y3RvcnNcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQYXJ0IDEgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgLy8gaWYgaW5wdXQgZWxlbWVudCBpcyBub3QgdmFsaWRcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgLy8gRXJyb3IgbWVzc2FnZSByZWZlcnJlZCB0byBhcyAndGhpcydcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlOyAvL2RpZmZlclxyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUGFydCAyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ0xlYXJzIGVycm9ycyBhbmQgY29udHJvbGxzIHN1Ym1pdCBidXR0b25cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgLy8gQ2hlY2tzIGFsbCBcIm1vZGFsX19pbnB1dFwiIGZvciB2YWxpZGl0eVxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIC8qIERvbid0IG5lZWQgdG8gaGF2ZSBpbnB1dEVsZW1lbnQgaW4gcGFyYW1ldGVyXHJcbiAgICAgICBiZWNhdXNlIGFscmVhZHkgcmVmZXJyZWQgdG8gaW4gX3NldEV2ZW50TGlzdGVuZXJzPyAqL1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIC8vIHN1Ym1pdEJ1dHRvbiBpcyB3aXRoaW4gX3NldEV2ZW50TGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8vIENhbGxlZCBpbiBpbmRleC5qc1xyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJpbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgc2VsZWN0b3JzLFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgc2V0dGluZ3MsXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGNhcmRBZGRGb3JtLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtcyBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3Jtc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGUgaW5zdGFuY2VzIG9mIGNsYXNzZXMgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gSGlkZGVuIEltYWdlIE1vZGFsIFdpbmRvd1xyXG5jb25zdCB2aWV3Q2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKHNlbGVjdG9ycy52aWV3TW9kYWwpO1xyXG5cclxuLy8gUmVuZGVyIENhcmQgd2l0aCBTZWN0aW9uLCBzdFxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpOyAvLyBNYWtlIGNhcmQgYW5kIGltYWdlLW1vZGFsXHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpOyAvLyBBZGQgaW5pdGlhbENhcmRzXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2VsZWN0b3JzLmNhcmRMaXN0XHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEVkaXQtQnV0dG9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vLyBPYmplY3QgdmFsdWUgZXF1YWxzIGVkaXQgaW5wdXQtZmllbGRcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHVzZXJOYW1lOiBzZWxlY3RvcnMudXNlck5hbWUsXHJcbiAgdXNlckpvYjogc2VsZWN0b3JzLnVzZXJKb2IsXHJcbn0pO1xyXG5cclxuLy8gTWFuYWdlIGluaXRpYWwgcHJvZmlsZSBkYXRhLCBzdFxyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gam9iO1xyXG59XHJcblxyXG4vLyBDaGFuZ2UgZWRpdC1tb2RhbCBkYXRhIHdoZW4gc3VibWl0XHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybXMoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5lZGl0TW9kYWwsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0KSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIHByb2ZpbGVOYW1lOiBpbnB1dC50aXRsZSxcclxuICAgICAgcHJvZmlsZUpvYjogaW5wdXQuZGVzY3JpcHRpb24sXHJcbiAgICAgIC8vIENoYW5nZXMgaW5wdXQgZmllbGQgXCJuYW1lPSd0aXRsZSdcIiBkaXNwYWx5ZWQgb24gbWFpbiBIVE1MXHJcbiAgICB9KTtcclxuICAgIGVkaXRQcm9maWxlTW9kYWwuY2xvc2UoKTtcclxuICB9LFxyXG59KTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQWRkLUJ1dHRvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBVc2VzIGlucHV0cywgY3JlYXRlcyBjYXJkIGFuZCBhZGRzIHRvIGNhcmRTZWN0aW9uXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IG5ld2NhckRhdGEgPSBjcmVhdGVDYXJkKGRhdGEpOyAvLyBNYWtlcyBDYXJkXHJcbiAgY2FyZFNlY3Rpb24ucHJlcGVuZEl0ZW0obmV3Y2FyRGF0YSk7IC8vIEFkZHMgY2FyZCB0byBiZWdpbm5pbmdcclxufVxyXG4vLyBDcmVhdGVzIGNhcmQgYW5kIGltYWdlLW1vZGFsXHJcbmNvbnN0IGNyZWF0ZUNhcmQgPSAob2JqZWN0RGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgZGF0YTogb2JqZWN0RGF0YSxcclxuICAgICAgdG9nZ2xlSW1hZ2VDbGljazogKGltZ0RhdGEpID0+IHtcclxuICAgICAgICB2aWV3Q2FyZE1vZGFsLm9wZW4oaW1nRGF0YSk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59O1xyXG5cclxuLy8gQ2hhbmdlIGFkZC1tb2RhbCBkYXRhIHdoZW4gc3VibWl0LCBzdFxyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybXMoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5hZGRNb2RhbCxcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXQpID0+IHtcclxuICAgIGNvbnN0IG5ld0NhcmREYXRhID0geyBuYW1lOiBpbnB1dC50aXRsZSwgbGluazogaW5wdXQubGluayB9OyAvLyBtYWRlIG9mIG5ldyBpbnB1dHNcclxuICAgIHJlbmRlckNhcmQobmV3Q2FyZERhdGEpOyAvLyBVc2VzIGlucHV0cyBpbiBwcm9jZXNzIG9mIG1ha2luZyBuZXcgY2FyZFxyXG4gICAgYWRkQ2FyZE1vZGFsLmNsb3NlKCk7IC8vIEFsbG93cyB0byBjbG9zZVxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBWYWxpZGF0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIFZhbGlkYXRlIGZvciBlZGl0IGJ1dHRvbiAodXNlZCBJRClcclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcHJvZmlsZUVkaXRGb3JtKTtcclxuLy8gVmFsaWRhdGUgZm9yIGFkZCBidXR0b25cclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBjYXJkQWRkRm9ybSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBBUEkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgYXV0aFRva2VuOiBcImViNDMzNzczLTRkMmUtNGU0Mi05MDc2LTRkZDc3MWIxZTVlZlwiLFxyXG59KTtcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChyZXMpID0+IGNvbnNvbGUubG9nKHJlcykpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgIEluaXRpYXRlIGFsbCBpbnN0YW5jZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcclxudmlld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpOyAvLyBDYXJkIG1vZGFsXHJcbmVkaXRQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gRWRpdC1idXR0b24gbW9kYWxcclxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7IC8vIEFkZC1idXR0b24gbW9kYWxcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFsbCBvZiByZXN0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gV2hlbiB5b3UgY2xpY2sgZWRpdC1pY29uLi4uXHJcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7IC8vIFZhbHVlcyBlcXVhbCB0byBwYXN0IHZhbHVlc1xyXG4gIGVkaXRQcm9maWxlTW9kYWwub3BlbigpOyAvLyBPcGVuIG1vZGFsXHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7IC8vIFJlc2V0IHZhbGlkYXRpb25cclxufSk7XHJcbi8vIENsaWNrIGFkZC1pY29uLi4uXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkTW9kYWwub3BlbigpO1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbi8vIEhpZGRlbiBNb2RhbCB3aW5kb3dcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbW9kYWxUZXh0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIC8vIEFkZCBhbiBpbWFnZSB3aXRoOiBpbWcgJ3NyYycsIGltZyAnY2FwdGlvbicsIGFuZCB0ZXh0XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX21vZGFsSW1hZ2UuYWx0ID0gYEltYWdlICR7ZGF0YS5saW5rfWA7XHJcbiAgICB0aGlzLl9tb2RhbFRleHQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAvLyBDYWxsIG9uIG1ldGhvZCBmcm9tIHBhcmVudCAoUG9wdXApXHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIFNlY3Rpb24gY2xhc3MgaXMgJ3JlbmRlckNhcmQnIGFzIGFuIG9iamVjdFxyXG5jbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zOyAvLyBBcnJheSBvZiBkYXRhXHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyOyAvLyBGdW5jdGlvbiBjcmVhdGVzIGFuZCByZW5kZXJzIGRhdGFcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpOyAvLyBDbGFzcyBzZWxlY3RvclxyXG4gIH1cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgICAvLyBSZW5kZXJzIGVhY2ggZWxlbWVudCBvbiBhIHBhZ2VcclxuICB9XHJcbiAgLy8gQWRkcyBpbml0aWFsIGNhcmRzIGluIG9yZGVyXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gICAgLy8gVGFrZXMgYSBET00gZWxlbWVudCAodmlhIFNlbGVjdG9yKSBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyXHJcbiAgfVxyXG4gIC8vIFJldmVyc2UgbmV3IGNhcmRzXHJcbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xyXG4iLCIvLyBSZW5kZXJzIGluZm8gZmllbGRzIGluIHByb2ZpbGUtaWNvbiAoRWRpdC1CdXR0b24pXHJcbmNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lLCB1c2VySm9iIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZSk7XHJcbiAgICB0aGlzLl9wcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iKTtcclxuICAgIC8vIEdyYWJzIG9iamVjdCBvZiB1c2VyIGluZm9cclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mbyBhYm91dCB0aGUgdXNlclxyXG4gICAgLy8gSGFuZHkgd2hlbiBORUNFU1NBUlkgdG8gZGlzcGxheSB0aGUgdXNlciBkYXRhIGluIHRoZSBvcGVuIGZvcm1cclxuICB9XHJcbiAgc2V0VXNlckluZm8oeyBwcm9maWxlTmFtZSwgcHJvZmlsZUpvYiB9KSB7XHJcbiAgICAvLyBUYWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IG9uIHRoZSBwYWdlXHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHByb2ZpbGVOYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHByb2ZpbGVKb2I7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhLCB0b2dnbGVJbWFnZUNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgLy8gRGF0YSBwYXNzZWQgaW4gcmVuZGVyQ2FyZFxyXG4gICAgLy8gSW4gY2hhcmdlIG9mIG9ubHkgJ2NhcmQnXHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX3RvZ2dsZUltYWdlQ2xpY2sgPSB0b2dnbGVJbWFnZUNsaWNrO1xyXG5cclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBmdW5jdGlvbiwgaW5pdGlhdGVzIGNhcmQgZWxlbWVudHNcclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAvL1JlcGxhY2UgaW1hZ2UgYWx0IGFuZCBzcmMgKHRoaXMgZnJvbSBsaW5lIDU4KVxyXG4gICAgdGhpcy5faW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIC8vIFJlcGxhY2UgdGl0bGUgdGV4dGNvbnRlbnRcclxuICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIC8vIFJldHVybiAndGhpcydcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF90b2dnbGVDYXJkTGlrZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfTtcclxuXHJcbiAgX3RvZ2dsZUNhcmREZWxldGUgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9O1xyXG5cclxuICAvLyBIYW5kbGVycyBhcmUgY2FsbGVkIGFmdGVyIHRoZXkgZXhpc3RcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBXaGVuIGxpa2UtYnV0dG9uIGlzIGNsaWNrZWQuLi5cclxuICAgIHRoaXMuX2NhcmRMaWtlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl90b2dnbGVDYXJkTGlrZSgpKTtcclxuICAgIC8vIFdoZW4gZGVsZXRlLWJ1dHRvbiBpcyBjbGlja2VkLi4uXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5fdG9nZ2xlQ2FyZERlbGV0ZSgpXHJcbiAgICApO1xyXG4gICAgLy8gV2hlbiBpbWFnZSBpcyBjbGlja2VkLi4ubmFtZSBhbmQgbGluayBhcmUgdXNlZCFcclxuICAgIHRoaXMuX2ltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5fdG9nZ2xlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaW5pdGlhbENhcmRzIiwibmFtZSIsImxpbmsiLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY2FyZEFkZEZvcm0iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiUG9wdXAiLCJjb25zdHJ1Y3RvciIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJldnQiLCJjbG9zZSIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtcyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9pbnB1dEVsZW1lbnRzIiwiX3N1Ym1pdEJ1dHRvbiIsImlucHV0RWxlbWVudCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9lcnJvck1lc3NhZ2VFbCIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJyZXNldFZhbGlkYXRpb24iLCJldmVyeSIsImRpc2FibGVkIiwidmlld0NhcmRNb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsVGV4dCIsImRhdGEiLCJzcmMiLCJhbHQiLCJjYXJkU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlZEl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJ1c2VySW5mbyIsInVzZXJOYW1lIiwidXNlckpvYiIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUpvYiIsImVkaXRQcm9maWxlTW9kYWwiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwib2JqZWN0RGF0YSIsImNhcmRTZWxlY3RvciIsInRvZ2dsZUltYWdlQ2xpY2siLCJfY2FyZExpa2VCdG4iLCJ0b2dnbGUiLCJfY2FyZEVsZW1lbnQiLCJfbmFtZSIsIl9saW5rIiwiX3RvZ2dsZUltYWdlQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJfaW1hZ2VFbCIsIl90b2dnbGVDYXJkTGlrZSIsIl9jYXJkRGVsZXRlQnRuIiwiX3RvZ2dsZUNhcmREZWxldGUiLCJpbWdEYXRhIiwiYWRkQ2FyZE1vZGFsIiwibmV3Y2FyRGF0YSIsInJlbmRlckNhcmQiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiQXBpIiwiYmFzZVVybCIsImF1dGhUb2tlbiIsImdldEluaXRpYWxDYXJkcyIsInRoZW4iLCJyZXMiLCJjb25zb2xlIiwibG9nIiwiZmlsbFByb2ZpbGVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==